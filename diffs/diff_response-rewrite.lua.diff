21a22
> local ngx_header  = ngx.header
28a30
> local content_decode = require("apisix.utils.content-decode")
262a265,279
>         if ctx.response_encoding ~= nil then
>             local decoder = content_decode.dispatch_decoder(ctx.response_encoding)
>             if not decoder then
>                 core.log.error("filters may not work as expected ",
>                                "due to unsupported compression encoding type: ",
>                                ctx.response_encoding)
>                 return
>             end
>             body, err = decoder(body)
>             if err ~= nil then
>                 core.log.error("filters may not work as expected: ", err)
>                 return
>             end
>         end
> 
335a353
>         local response_encoding = ngx_header["Content-Encoding"]
336a355
>         ctx.response_encoding = response_encoding
